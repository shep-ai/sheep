# Task Breakdown (YAML)
# This is the source of truth. Markdown is auto-generated from this file.

name: state-machine-diagram
summary: >
  1 task in 1 phase. Create STATE_MACHINE.md at the repo root with a valid Mermaid
  stateDiagram-v2 diagram of the order fulfillment lifecycle. All spec requirements
  are satisfied by this single atomic file-creation step.

# Relationships
relatedFeatures: []

technologies:
  - Markdown
  - Mermaid stateDiagram-v2

relatedLinks:
  - https://mermaid.js.org/syntax/stateDiagram.html

tasks:
  - id: task-1
    phaseId: phase-1
    title: 'Create STATE_MACHINE.md with order fulfillment stateDiagram-v2'
    description: >
      Create the file STATE_MACHINE.md at the repository root. The file must follow
      the terse content convention (heading → prose intro → Mermaid code block) and
      contain a valid stateDiagram-v2 diagram of the order fulfillment lifecycle with
      6 named states, a happy path, and a cancellation branch from three states.
      No existing files are modified.
    state: Todo
    dependencies: []
    acceptanceCriteria:
      - 'File STATE_MACHINE.md exists at the repository root'
      - 'First line is a level-1 Markdown heading (e.g., `# Order Fulfillment State Machine`)'
      - 'File contains 1–3 sentences of prose before the diagram'
      - 'File contains exactly one fenced code block with language tag `mermaid`'
      - 'Code block opens with `stateDiagram-v2` on its first line'
      - 'Diagram defines exactly 6 named states: placed, payment_pending, paid, shipped, delivered, cancelled'
      - 'Diagram includes `[*] --> placed` as the initial transition'
      - 'Both delivered and cancelled have a transition to `[*]` (terminal states)'
      - 'At least one state has 2+ outgoing transitions (placed, payment_pending, and paid each transition to both the next happy-path state and cancelled)'
      - 'Transition labels use action verbs on non-obvious transitions (e.g., "pay", "ship", "cancel")'
      - 'State names use snake_case throughout'
      - 'File is ≤ 50 lines'
      - 'No existing files are modified'
    tdd:
      red:
        - >
          Before creating the file, verify STATE_MACHINE.md does not exist at the repo root
          (`ls STATE_MACHINE.md` should return "No such file"). This is the failing state —
          every acceptance criterion above is unmet.
      green:
        - >
          Create STATE_MACHINE.md with:
            1. `# Order Fulfillment State Machine` as line 1
            2. A 1–2 sentence prose intro describing the order lifecycle scenario
            3. A fenced ```mermaid block containing stateDiagram-v2 with:
               - `[*] --> placed`
               - `placed --> payment_pending : submit order`
               - `placed --> cancelled : cancel`
               - `payment_pending --> paid : pay`
               - `payment_pending --> cancelled : cancel`
               - `paid --> shipped : ship`
               - `paid --> cancelled : cancel`
               - `shipped --> delivered`
               - `delivered --> [*]`
               - `cancelled --> [*]`
        - >
          Verify the file exists and count lines (must be ≤ 50). Count named states in
          the diagram body (must be exactly 6, excluding [*]).
      refactor:
        - >
          Review each acceptance criterion in order and confirm it is met:
          heading present, prose intro present, single mermaid block, stateDiagram-v2
          declaration, correct state count, [*] transitions, branching points, transition
          labels, snake_case names, line count, no other files modified.
        - >
          Read the Mermaid syntax once more to confirm there are no typos, missing arrows
          (-->), or unclosed blocks that would cause a render failure on GitHub.
    estimatedEffort: '15min'

totalEstimate: '15min'
openQuestions: []

content: |
  ## Summary

  The entire feature is one atomic task: write STATE_MACHINE.md. There are no
  dependencies to set up, no libraries to install, no existing code to modify, and
  no sequencing concerns. The TDD cycle is adapted for content authoring: the RED
  phase establishes that the file doesn't exist yet (all criteria unmet), the GREEN
  phase creates the file with correct structure and diagram topology, and the REFACTOR
  phase is a systematic review pass against every acceptance criterion followed by a
  final syntax check.

  The diagram topology (6 states, cancellation from three points, two terminal states)
  was fully determined during research and is captured verbatim in the GREEN step above,
  so implementation is mechanical: transcribe the topology, add minimal action-verb
  labels, wrap in the file structure, and verify.
